#!/bin/bash

LOG_FILE=~/setup.log
exec > >(tee -a "$LOG_FILE") 2>&1

echo "Starting simplified setup script..." $(date)

# Function to check last command status
check_status() {
    if [ $? -eq 0 ]; then
        echo "Success: $1"
    else
        echo "Error: $1 failed"
    fi
}

# Step 1: Install packages
echo "Installing required packages..."
sudo pacman -Syu --noconfirm
sudo pacman -S --needed --noconfirm hyprland wayland kitty sddm xdg-desktop-portal-hyprland
check_status "Package installation"

# Step 2: Enable SDDM
echo "Enabling SDDM service..."
sudo systemctl enable sddm.service
check_status "SDDM service enablement"

# Step 3: Create necessary config directories
echo "Creating config directories..."
mkdir -p ~/.config/{hypr,kitty}
check_status "Config directory creation"

# Step 4: Copy configuration files
echo "Copying configuration files..."
cp ./hyprland.conf ~/.config/hypr/
cp ./kitty.conf ~/.config/kitty/
check_status "Configuration file copying"

echo "Setup completed successfully. Please reboot to start using your new Hyprland setup."